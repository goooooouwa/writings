<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Story template Consumer view health status of ThoughtAPI | 开放笔记</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Story template Consumer view health status of ThoughtAPI" />
<meta name="author" content="徐顺发" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Story template: Consumer: view health status of ThoughtAPI" />
<meta property="og:description" content="Story template: Consumer: view health status of ThoughtAPI" />
<link rel="canonical" href="https://goooooouwa.github.io/business-analysis/2019/02/15/story-template-consumer-view-health-status-of-thoughtapi.html" />
<meta property="og:url" content="https://goooooouwa.github.io/business-analysis/2019/02/15/story-template-consumer-view-health-status-of-thoughtapi.html" />
<meta property="og:site_name" content="开放笔记" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-02-15T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Story template Consumer view health status of ThoughtAPI" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"徐顺发"},"dateModified":"2019-02-15T00:00:00+00:00","datePublished":"2019-02-15T00:00:00+00:00","description":"Story template: Consumer: view health status of ThoughtAPI","headline":"Story template Consumer view health status of ThoughtAPI","mainEntityOfPage":{"@type":"WebPage","@id":"https://goooooouwa.github.io/business-analysis/2019/02/15/story-template-consumer-view-health-status-of-thoughtapi.html"},"url":"https://goooooouwa.github.io/business-analysis/2019/02/15/story-template-consumer-view-health-status-of-thoughtapi.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://goooooouwa.github.io/feed.xml" title="开放笔记" /><script async src="https://www.googletagmanager.com/gtag/js?id=G-669F0VG7BL"></script>
<script>
  window['ga-disable-G-669F0VG7BL'] = window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1";
  window.dataLayer = window.dataLayer || [];
  function gtag(){window.dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-669F0VG7BL');
</script>
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="/favicon.ico">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="theme-color" content="#ffffff">
<link rel="stylesheet" href="/assets/css/google-custom-search-style-fix.css">
<script data-ad-client="ca-pub-6847741633817418" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script src=/assets/javascript/chartjs-2.9.3/chart.min.js></script>
<script src=/assets/javascript/mermaid-8.7.0/mermaid.min.js></script></head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">开放笔记</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/categories.html">分类</a><a class="page-link" href="/tags.html">标签</a><a class="page-link" href="/wiki.html">Wiki</a><a class="page-link" href="/docs.html">共享文档</a><a class="page-link" href="/about/">关于作者</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Story template Consumer view health status of ThoughtAPI</h1>
    <p class="post-meta"><time class="dt-published" datetime="2019-02-15T00:00:00+00:00" itemprop="datePublished">
        Feb 15, 2019
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h1 id="story-template-consumer-view-health-status-of-thoughtapi">Story template: Consumer: view health status of ThoughtAPI</h1>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>h2. Business Value
*As a* Consumer/Publisher/Cons-admin/Pub-admin,
*I want to* view health status metrics of ThoughtAPI,
*So that* I know the reliability of ThoughtAPI.

h2. User Journey
https://docs.google.com/presentation/d/1bZWhO-byImuy7emHsolzb5VyVK5SBt6UtVz2WvsDc70/edit#slide=id.g1c9ca5108_1270

h2. Common Knowledge
# *Role &amp; Permission*: if not explicitly described otherwise, every functionality works the same for all user roles having permission using it. See [Permission lookup table|https://docs.google.com/spreadsheets/d/1cgtcZwBf59Yr7XZtCt_aLGcfM36Ek-BPc-6uJaLrMH0/edit#gid=0] for details.
# *Page Routing*: please follow [Page Routing Principles|https://docs.google.com/spreadsheets/d/1jYxtXSqwOxl3BY0v9iEs8GNMfu70hOXeDIqyvy-R-c8/edit#gid=501674950] if a page routing error occurs.
# *Security*: must follow [Security Guidelines|https://docs.google.com/spreadsheets/d/16rBYvFsEvN6ewTS3V4eQrCyeiifS1iw8HqDRobIXGgA/edit#gid=0].

h2. Acceptance Criteria

+AC Consumer can see all time in UTC+0 format in status page+
GIVEN Ling in ThoughtAPI status page,
THEN she can see all time in status page are in UTC+0 format.

+AC Consumer can see Current Health Status of ThoughtAPI+
GIVEN Ling in ThoughtAPI status page,
THEN she can see Current Health Status (see UI Spec) of ThoughtAPI.

+AC Consumer can interact with Current Health Status of ThoughtAPI+
GIVEN Ling in ThoughtAPI status page,
WHEN she interact (see UI Spec) with Current Health Status of ThoughtAPI,
THEN she can see Current Health Status of ThoughtAPI behave as defined in UI Spec.

+AC Consumer can see Health Status History Graph of ThoughtAPI+
GIVEN Ling in ThoughtAPI status page,
THEN she can see Health Status History Graph (see UI Spec) of ThoughtAPI.

+AC Consumer can interact with Health Status History Graph of ThoughtAPI+
GIVEN Ling in ThoughtAPI status page,
WHEN she interact (see UI Spec) with Health Status History Graph of ThoughtAPI,
THEN she can see Health Status History Graph of ThoughtAPI behave as defined in UI Spec.


h2. Definition of Terms
h3. Real Time
Current displayed status is the actual status within 60 seconds range.

h3. Current time
计算uptime percentage的代码执行的时刻

h3. Today
Day of Current time in UTC+0

h3. Past N Days
从Today之前（不包括Today）的第N-1天到Today的时间区间中的所有Single Days。
假如今天是1997年7月16日，Past 2 Days就是从1997年7月15日到1997年7月16日的时间区间。

h3. Start of Day
1997年7月16日的Start of Day为：
1997-07-16T00:00:00.00+00:00

h3. End of Day
1997年7月16日的End of Day为：
1997-07-16T23:59:59.99+00:00

h3. Single Day
对于已到达End of Day的某一天，Single Day为Start of Day到End of Day；
对于未到达End of Day的某一天，Single Day为Start of Day到Current time；

h3. Real Time Health Status
监控对象的Real Time的健康状态，包括3种状态值：
- Healthy
- Unhealthy
- Unknown

不同监控对象的健康状态的定义不一样，要case by case来看。
对于ThoughtAPI的每一个组件，3种状态值的定义为：
- Healthy: Prometheus存储的对应时刻的组件状态为Healthy
- Unhealthy: Prometheus存储的对应时刻的组件状态为Unhealthy
- Unknown: Prometheus没有存储对应时刻的组件状态值

对于ThoughtAPI，3种状态值的定义为：
- Healthy: 所有（Prometheus以外的）组件Real Time Health Status为Healthy
- Unhealthy: 至少一个组件Real Time Health Status为Unhealthy或Unknown
- Unknown: 所有组件Real Time Health Status为Unknown

对于被管理的API，3种状态值的定义为：
- Healthy: Prometheus存储的对应时刻的API状态为Healthy
- Unhealthy: Prometheus存储的对应时刻的API状态为Unhealthy
- Unknown: Prometheus没有存储对应时刻的API状态值

h3. Single Day Uptime Percentage
某Single Day中，监控对象被检查到的health的次数 / 对象被检查到的healthy + unhealthy的次数。
Uptime Percentage有3种可能：
- Valid数值: [0-100]%
- Initial: 没有加进来
- Unknown: 加进来了，但是没有任何监控数据

h3. Past 90 Days Uptime Percentage
Past 90 Days中，监控对象被检查到的health的次数 / 对象被检查到的healthy + unhealthy的次数。


h2. UI Spec
link: https://preview.uxpin.com/c8d4194e8f4122661829775772b1a94109300243#/pages/94626430/simulate/no-panels?mode=i

h3. Current Health Status

h4. Health Status Icon
显示监控对象的Real Time Health Status对应的颜色见UX Design.

h4. UI Text
{noformat}
API Gateway Status
{noformat}

{noformat}
Current Status
{noformat}

Tooltip
{noformat}
Realtime: [Healthy | Unhealthy | Unknown]
{noformat}

h4. Interaction Behaviours
鼠标hover上Health Status Icon时显示Tooltip。

h3. Health Status History Graph

h4. Health Status Bar
显示监控对象某一天的Single Day Uptime Percentage对应的颜色见UX Design.

h4. History Graph
X轴：90个Health Status Bar。每个Health Status Bar对应其中一天的Single Day Health Status。最左侧的是90天前的Single Day Health Status，最右侧的是Today的Single Day Health Status。

h4. UI Text:
{noformat}
90 days ago
{noformat}

Uptime percentage of Past 90 Days (uptime保留小数点后两位，小数点后末位0不展示), e.g.
{noformat}
[99.99]% uptime
{noformat}

{noformat}
Today
{noformat}

Date of Single Day selected (default is Today), e.g.
{noformat}
2019.01.03 UTC+0
{noformat}

Uptime Percentage of Single Day selected (default is Today,  uptime保留小数点后两位，小数点后末位0不展示), e.g.
{noformat}
[99.99]%
{noformat}

h4. Interaction Behaviours
鼠标hover任何一个Single Day的Health Status Bar时：

1. 如果hover的Health Status Bar对应的Single Day Uptime Percentage为Valid数值时，
Health Status Bar样式见UX Design.

右边Single Day selected的text变为：
Date: Date of Single Day selected
Uptime Percentage: Uptime Percentage of Single Day selected

2. 如果hover的Health Status Bar对应的Single Day Uptime Percentage为Initial时，
Health Status Bar样式无变化。

右边Single Day selected的text无变化。

3. 如果hover的Health Status Bar对应的Single Day Uptime Percentage为Unknown时，
Health Status Bar样式见UX Design.

右边Single Day selected的text变为：
Date:
{noformat}
[Date of Single Day selected]
{noformat}

Uptime Percentage:
{noformat}
Unknown
{noformat}

h2. Technical Requirements:
all time related calculation in any metrics are based on UTC time
check APIGW/API health status的时间间隔：30s
Server端: 可以设置不同的时间窗，最多可提供从有数据日期开始到今天的所有数据，终止日期也可以不是今天，可以是任何日期。，提供不同时间的uptime计算

h2. Test Scenario
</code></pre></div></div>

  </div>

  <!-- <div class="reward">
    <p>觉得文章对你有帮助？打赏以支持作者持续创作：</p>
    <div class="reward-button">
      <span class="alipay-code"><img class="alipay-img wdp-appear" alt="支付宝打赏" src="https://goooooouwa.eu.org:8143/static/images/alipay_paycode.jpg"></span>
    </div>
  </div> --><script src="https://utteranc.es/client.js" repo="goooooouwa/goooooouwa.github.io" issue-term="pathname"
    theme="github-light" crossorigin="anonymous" async>
    </script>

  <a class="u-url" href="/business-analysis/2019/02/15/story-template-consumer-view-health-status-of-thoughtapi.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>订阅</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">徐顺发</li>
          <li><a class="u-email" href="mailto:gouwa5700 (at) gmail (dot) com">gouwa5700 (at) gmail (dot) com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>记录生活、学习和思考
</p>
        <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a><br />本网站采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议</a>进行许可。
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li>
  <a rel="me" href="https://github.com/goooooouwa" target="_blank" title="github">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#github"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://twitter.com/Goooooouwa" target="_blank" title="twitter">
    <svg class="svg-icon grey">
      <use xlink:href="/assets/minima-social-icons.svg#twitter"></use>
    </svg>
  </a>
</li>
</ul>
</div>

  </div>

</footer>
</body>

</html>